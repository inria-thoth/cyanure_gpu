<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorials &mdash; Cyanure 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Benchmarks" href="benchmarks.html" />
    <link rel="prev" title="Preprocessing functions" href="pythonAPI/data_processing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Cyanure
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Welcome to Cyanure GPU’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="welcome.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="welcome.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythonAPI/pythonAPI.html">Python API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples-for-binary-classification">Examples for binary classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiclass-classification">Multiclass classification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cyanure</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorials</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorials.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Many of the datasets I used are available <a class="reference external" href="http://pascal.inrialpes.fr/data2/mairal/data/">here</a>.</p>
</div>
<p>For each dataset, we first give the result with the CPU version library and then the GPU one.</p>
<div class="section" id="examples-for-binary-classification">
<h2>Examples for binary classification<a class="headerlink" href="#examples-for-binary-classification" title="Permalink to this heading"></a></h2>
<p>The following code performs binary classification with <span class="math notranslate nohighlight">\(\ell_2\)</span>-regularized logistic regression, with no intercept, on the ocr dataset (23.1Gb):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.data_processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1">#load rcv1 dataset about 1Gb, n=781265, p=47152</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s1">&#39;ocr.npz&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;arr_1&#39;</span><span class="p">])</span>
<span class="n">X</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>

<span class="c1">#normalize the rows of X in-place, without performing any copy</span>
<span class="n">preprocess</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#declare a binary classifier for l2-logistic regression  uses the auto solver by default, performs at most 500 epochs</span>
<span class="n">classifier</span><span class="o">=</span><span class="n">Classifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span><span class="n">lambda_1</span><span class="o">=</span><span class="mf">0.001953125</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">duality_gap_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Before we comment the previous choices, let us
run the above code on one Intel(R) Xeon(R) Gold 6430 having access to 126 Go of RAM and a NVIDIA 6000 ADA GPU (48 Go of memory).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Info</span> <span class="p">:</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2500000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1155</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Catalyst</span> <span class="n">Accelerator</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">L2</span> <span class="n">regularization</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.68547309280959156652</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">32.47520999999999702368</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.03308400807599472249</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.67945171539393311999</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">62.51010200000000338605</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.02137987285656091016</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.67547586698653583337</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">92.48795599999999694774</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.01415023353528127754</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.67284701111919842376</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">122.08335099999999329157</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00939130161126555500</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.67110736628657929881</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">150.75117199999999684223</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00623283340952181155</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.66995531732809265879</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">180.08448400000000333421</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00413627674201270425</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.66919185798389579922</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">208.72120499999999765350</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00274527966941450624</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.66868557141165807511</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">238.07016100000001301851</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00182258662660126974</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.66834960668510767778</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">267.40909900000002608067</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00121049088143456362</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.66812652198281208271</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">296.27869800000001987428</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00080433396431857948</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Time</span> <span class="n">elapsed</span> <span class="p">:</span> <span class="mf">297.86861499999997704435</span>


<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">288</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">simple_erm</span> <span class="o">-</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2500000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1155</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">314</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">Catalyst</span> <span class="n">Accelerator</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">314</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">ista</span> <span class="o">-</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">400</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="o">*********************************</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">401</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">logistic</span> <span class="o">-</span> <span class="n">Logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">401</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">ridge</span> <span class="o">-</span> <span class="n">L2</span> <span class="n">regularization</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">458</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.68547308444976806641</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.92639</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">491</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.03308409452438354492</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">142</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.67945176362991333008</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.81144</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">174</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.02137989178299903870</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">826</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.67547589540481567383</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.49520</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">858</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.01415032148361206055</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">695</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.67284703254699707031</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">3.36445</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">727</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00939132738858461380</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">378</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.67110735177993774414</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.04747</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">411</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00623279577121138573</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">062</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.66995537281036376953</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.73148</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">096</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00413630390539765358</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">747</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.66919183731079101562</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.41596</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">779</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00274521391838788986</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">563</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.66868561506271362305</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">6.23248</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">595</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00182258465792983770</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">247</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.66834962368011474609</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">6.91590</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">279</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00121046497952193022</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">930</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.66812652349472045898</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">7.59990</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">963</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00080433191033080220</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">963</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mf">7.599904775619507</span>
</pre></div>
</div>
<p>The solver used was <em>catalyst-ista</em>; the problem was solved up to
accuracy tol=0.001 in about 7.6 sec after 100 epochs (without taking into account
the time to load the dataset from the hard drive). The regularization
parameter is the one given by cross-validation. We can see that the GPU version is about 40 times faster.</p>
<p>In the next example, we use the logistic loss with
<span class="math notranslate nohighlight">\(\ell_1\)</span>-regularization, the regularization parameter is such that the
obtained solution has 0.1% non-zero coefficients.
We also fit an intercept.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.data_processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1">#load rcv1 dataset about 1Gb, n=781265, p=47152</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s1">&#39;epsilon.npz&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;arr_1&#39;</span><span class="p">])</span>
<span class="n">X</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>

<span class="c1">#normalize the rows of X in-place, without performing any copy</span>
<span class="n">preprocess</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#declare a binary classifier for squared hinge loss + l1 regularization</span>
<span class="n">classifier</span><span class="o">=</span><span class="n">Classifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span><span class="n">lambda_1</span><span class="o">=</span><span class="mf">0.000244140625</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">duality_gap_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># uses the auto solver by default, performs at most 500 epochs</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>which yields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Info</span> <span class="p">:</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">250000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2000</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Catalyst</span> <span class="n">Accelerator</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">L1</span> <span class="n">regularization</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.69314561929310380961</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.66298200000000040433</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00000015295459037478</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Time</span> <span class="n">elapsed</span> <span class="p">:</span> <span class="mf">5.92307700000000014739</span>


<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">709</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">simple_erm</span> <span class="o">-</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">250000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2000</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">782</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">Catalyst</span> <span class="n">Accelerator</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">782</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">ista</span> <span class="o">-</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">798</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="o">*********************************</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">798</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">logistic</span> <span class="o">-</span> <span class="n">Logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">07</span><span class="p">,</span><span class="mi">798</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">lasso</span> <span class="o">-</span> <span class="n">L1</span> <span class="n">regularization</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">029</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.69314563274383544922</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.20345</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">074</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.71983032259959145449e-07</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">22</span> <span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">08</span><span class="p">,</span><span class="mi">074</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.2034461498260498</span>
</pre></div>
</div>
</div>
<div class="section" id="multiclass-classification">
<h2>Multiclass classification<a class="headerlink" href="#multiclass-classification" title="Permalink to this heading"></a></h2>
<p>Let us now do something a bit more involved and perform multinomial logistic regression on the
<em>ckn_mnist</em> dataset (10 classes, n=60000, p=2304, dense matrix), with <span class="math notranslate nohighlight">\(\ell_2\)</span> regularization,
still using an Intel(R) Xeon(R) Gold 6430 having access to 126 Go of RAM and a NVIDIA 6000 ADA GPU.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.data_processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1">#load ckn_mnist dataset 10 classes, n=60000, p=2304</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s1">&#39;ckn_mnist.npz&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>

<span class="c1">#center and normalize the rows of X in-place, without performing any copy</span>
<span class="n">preprocess</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">centering</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#declare a multinomial logistic classifier with group Lasso regularization</span>
<span class="n">classifier</span><span class="o">=</span><span class="n">Classifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;multiclass-logistic&#39;</span><span class="p">,</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;qning-ista&#39;</span><span class="p">,</span> <span class="n">lambda_1</span><span class="o">=</span><span class="mf">0.0009765625</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span><span class="n">duality_gap_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># uses the auto solver by default, performs at most 500 epochs</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Info</span> <span class="p">:</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2304</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Memory</span> <span class="n">parameter</span><span class="p">:</span> <span class="mi">20</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">QNing</span> <span class="n">Accelerator</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Multiclass</span> <span class="n">logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">L2</span> <span class="n">regularization</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.34660935401916503906</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.07866200000000000969</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.40878400206565856934</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.17538738250732421875</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.93717999999999990202</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.01453427784144878387</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.16761827468872070312</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.79002499999999997726</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00151061406359076500</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.16685760021209716797</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">3.64184000000000018815</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00085969886276870966</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.16679251194000244141</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.50452000000000030155</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00001185153087135404</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.16678476333618164062</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">5.46062199999999986488</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00000143036663757812</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">1.16678380966186523438</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mf">6.96293999999999968509</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00000398459633288439</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Time</span> <span class="n">elapsed</span> <span class="p">:</span> <span class="mf">7.04140799999999966730</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Total</span> <span class="n">additional</span> <span class="n">line</span> <span class="n">search</span> <span class="n">steps</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Total</span> <span class="n">skipping</span> <span class="n">l</span><span class="o">-</span><span class="n">bfgs</span> <span class="n">steps</span><span class="p">:</span> <span class="mi">2</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">101</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2304</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">158</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">QNing</span> <span class="n">Accelerator</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">158</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">ista</span> <span class="o">-</span> <span class="n">ISTA</span> <span class="n">Solver</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">219</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">Memory</span> <span class="n">parameter</span><span class="p">:</span> <span class="mi">20</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">227</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="o">*********************************</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">227</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_class_logistic</span> <span class="o">-</span> <span class="n">Multiclass</span> <span class="n">logistic</span> <span class="n">Loss</span> <span class="ow">is</span> <span class="n">used</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">227</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">ridge</span> <span class="o">-</span> <span class="n">L2</span> <span class="n">regularization</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">708</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.34660909712377696579</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.50826</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">776</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.40876695758362174837</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">918</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.17538727249934416008</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.75384</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">929</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.01456019001919470722</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">074</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16761827068007839614</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.90962</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">085</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00151743933299837062</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">232</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16685757526350597502</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.06818</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">244</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.00086651061339404446</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">394</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16679242465549570795</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.22931</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">405</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.85046781787790604848e-05</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">576</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678509730836377223</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.41183</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">587</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">5.21347885587373416951e-06</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">730</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678362581394057251</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.56620</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">741</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.20806198834368214258e-07</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">885</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678349137343806419</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.72061</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">896</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.28692449350012228603e-08</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">039</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678347677815530403</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.87507</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">050</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.18125686726953981710e-09</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">194</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678347529696058160</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.02985</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">205</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">2.89937497949730604950e-10</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">349</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Epoch</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="n">primal</span> <span class="n">objective</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.16678347518372782510</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">),</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.18473</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">359</span> <span class="o">-</span> <span class="n">WARNING</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">The</span> <span class="n">solution</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">improve</span> <span class="n">anymore</span><span class="p">,</span> <span class="n">solving</span> <span class="n">has</span> <span class="n">been</span> <span class="n">stopped</span><span class="o">.</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">360</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">Best</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">3.60835205423188893144e-11</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">360</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">solver</span> <span class="o">-</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mf">2.1847290992736816</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">360</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">Total</span> <span class="n">additional</span> <span class="n">line</span> <span class="n">search</span> <span class="n">steps</span><span class="p">:</span> <span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">360</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">accelerator</span> <span class="o">-</span> <span class="n">Total</span> <span class="n">skipping</span> <span class="n">l</span><span class="o">-</span><span class="n">bfgs</span> <span class="n">steps</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Learning the multiclass classifier took about 2.2s. To conclude, we provide a last more classical example
of learning l2-logistic regression classifiers on the same dataset, in a one-vs-all fashion.
We notice that the CPU version greatly benifits from the number of cores which allows to parralelize all the solvers.
That’s why the GPU version is more than twice solver.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cyanure_pytorch.data_processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1">#load ckn_mnist dataset 10 classes, n=60000, p=2304</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s1">&#39;ckn_mnist.npz&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>

<span class="c1">#center and normalize the rows of X in-place, without performing any copy</span>
<span class="n">preprocess</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">centering</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#declare a multinomial logistic classifier with group Lasso regularization</span>
<span class="n">classifier</span><span class="o">=</span><span class="n">Classifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span><span class="n">lambda_1</span><span class="o">=</span><span class="mf">58.59375</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">duality_gap_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;ovr&quot;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># uses the auto solver by default, performs at most 500 epochs</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, the 10 classifiers are learned in parallel using the 2 CPUs, which gives the following output after about 18 sec:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Info</span> <span class="p">:</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2304</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">8</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">20.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">10.96056175231933593750</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.24975199997425079346</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00000107394896531332</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">0</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">20.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">11.69469165802001953125</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.20580284297466278076</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00000890581850399030</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">4</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">20.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">12.47539710998535156250</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.22394967079162597656</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00000459112152384478</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">7</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">20.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">15.23751926422119140625</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.17513881623744964600</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00000059557402209975</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">3</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">20.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">15.92408370971679687500</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.20927692949771881104</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.00000583865221415181</span>
<span class="ne">Warning</span> <span class="p">:</span> <span class="n">Your</span> <span class="n">problem</span> <span class="ow">is</span> <span class="n">prone</span> <span class="n">to</span> <span class="n">numerical</span> <span class="n">instability</span><span class="o">.</span> <span class="n">It</span> <span class="n">would</span> <span class="n">be</span> <span class="n">safer</span> <span class="n">to</span> <span class="n">use</span> <span class="n">double</span><span class="o">.</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">2</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">50.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">29.63804054260253906250</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.22416828572750091553</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00007252215436892584</span>
<span class="ne">Warning</span> <span class="p">:</span> <span class="n">Your</span> <span class="n">problem</span> <span class="ow">is</span> <span class="n">prone</span> <span class="n">to</span> <span class="n">numerical</span> <span class="n">instability</span><span class="o">.</span> <span class="n">It</span> <span class="n">would</span> <span class="n">be</span> <span class="n">safer</span> <span class="n">to</span> <span class="n">use</span> <span class="n">double</span><span class="o">.</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">5</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">70.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">35.79794311523437500000</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.18814966082572937012</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00001275095019082073</span>
<span class="ne">Warning</span> <span class="p">:</span> <span class="n">Your</span> <span class="n">problem</span> <span class="ow">is</span> <span class="n">prone</span> <span class="n">to</span> <span class="n">numerical</span> <span class="n">instability</span><span class="o">.</span> <span class="n">It</span> <span class="n">would</span> <span class="n">be</span> <span class="n">safer</span> <span class="n">to</span> <span class="n">use</span> <span class="n">double</span><span class="o">.</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">6</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">70.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">36.60394668579101562500</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.19530247151851654053</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00038812740240246058</span>
<span class="ne">Warning</span> <span class="p">:</span> <span class="n">Your</span> <span class="n">problem</span> <span class="ow">is</span> <span class="n">prone</span> <span class="n">to</span> <span class="n">numerical</span> <span class="n">instability</span><span class="o">.</span> <span class="n">It</span> <span class="n">would</span> <span class="n">be</span> <span class="n">safer</span> <span class="n">to</span> <span class="n">use</span> <span class="n">double</span><span class="o">.</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">1</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">80.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">39.07707595825195312500</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.13079862296581268311</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00001492410319769988</span>
<span class="ne">Warning</span> <span class="p">:</span> <span class="n">Your</span> <span class="n">problem</span> <span class="ow">is</span> <span class="n">prone</span> <span class="n">to</span> <span class="n">numerical</span> <span class="n">instability</span><span class="o">.</span> <span class="n">It</span> <span class="n">would</span> <span class="n">be</span> <span class="n">safer</span> <span class="n">to</span> <span class="n">use</span> <span class="n">double</span><span class="o">.</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Solver</span> <span class="mi">9</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">90.00000000000000000000</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">39.81833648681640625000</span> <span class="n">seconds</span>
<span class="n">Info</span> <span class="p">:</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.25878179073333740234</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">0.00001071024325938197</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Time</span> <span class="k">for</span> <span class="n">the</span> <span class="n">one</span><span class="o">-</span><span class="n">vs</span><span class="o">-</span><span class="nb">all</span> <span class="n">strategy</span>
<span class="n">Info</span> <span class="p">:</span> <span class="n">Time</span> <span class="n">elapsed</span> <span class="p">:</span> <span class="mf">39.84983400000000131058</span>



<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">836</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Matrix</span> <span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2304</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span><span class="mi">789</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">0</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.92084789276123</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span><span class="mi">790</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.20580457427388008</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">9.707249846837206e-06</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">36</span><span class="p">,</span><span class="mi">610</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">1</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.775974750518799</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">36</span><span class="p">,</span><span class="mi">610</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.1307992765715999</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">1.2421890926748529e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span><span class="mi">379</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">2</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.723823070526123</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span><span class="mi">379</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.22417289945725252</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">2.7430488492892824e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="mi">162</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">3</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.736879825592041</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="mi">163</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.20928146978693712</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">2.208283650841875e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">02</span><span class="p">,</span><span class="mi">977</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">4</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.773399114608765</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">02</span><span class="p">,</span><span class="mi">977</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.22395336127456733</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">2.3133542221329766e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">773</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">5</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.750984191894531</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">773</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.18815317301783568</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">2.5039743133227696e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="mi">538</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">6</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.718018531799316</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="mi">539</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.19528435559928414</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">1.3474321095759592e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">29</span><span class="p">,</span><span class="mi">362</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">7</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.782743215560913</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">29</span><span class="p">,</span><span class="mi">362</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.17514023007756355</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">1.2594092475734544e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">157</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">8</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.750588417053223</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">158</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.24975907330736724</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">3.1220033296235936e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span><span class="mi">923</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Solver</span> <span class="mi">9</span> <span class="n">has</span> <span class="n">terminated</span> <span class="n">after</span> <span class="mf">500.0</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">8.72121000289917</span> <span class="n">seconds</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span><span class="mi">923</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span>    <span class="n">Primal</span> <span class="n">objective</span><span class="p">:</span> <span class="mf">0.25878863035262567</span><span class="p">,</span> <span class="n">relative</span> <span class="n">duality</span> <span class="n">gap</span><span class="p">:</span> <span class="mf">3.7129335857905706e-05</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span><span class="mi">924</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Time</span> <span class="k">for</span> <span class="n">the</span> <span class="n">one</span><span class="o">-</span><span class="n">vs</span><span class="o">-</span><span class="nb">all</span> <span class="n">strategy</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">21</span> <span class="mi">15</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span><span class="mi">924</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">multi_erm</span> <span class="o">-</span> <span class="n">Elapsed</span> <span class="n">time</span><span class="p">:</span> <span class="mf">88.08702564239502</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pythonAPI/data_processing.html" class="btn btn-neutral float-left" title="Preprocessing functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="benchmarks.html" class="btn btn-neutral float-right" title="Benchmarks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Julien Mairal.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>